function xhs_hash_0531(input_string) {
    let data_dict_0520_bak = {
        102: [
            16843776,
            0,
            65536,
            16843780,
            16842756,
            66564,
            4,
            65536,
            1024,
            16843776,
            16843780,
            1024,
            16778244,
            16842756,
            16777216,
            4,
            1028,
            16778240,
            16778240,
            66560,
            66560,
            16842752,
            16842752,
            16778244,
            65540,
            16777220,
            16777220,
            65540,
            0,
            1028,
            66564,
            16777216,
            65536,
            16843780,
            4,
            16842752,
            16843776,
            16777216,
            16777216,
            1024,
            16842756,
            65536,
            66560,
            16777220,
            1024,
            4,
            16778244,
            66564,
            16843780,
            65540,
            16842752,
            16778244,
            16777220,
            1028,
            66564,
            16843776,
            1028,
            16778240,
            16778240,
            0,
            65540,
            66560,
            0,
            16842756
        ],
        103: [
            -2146402272,
            -2147450880,
            32768,
            1081376,
            1048576,
            32,
            -2146435040,
            -2147450848,
            -2147483616,
            -2146402272,
            -2146402304,
            -2147483648,
            -2147450880,
            1048576,
            32,
            -2146435040,
            1081344,
            1048608,
            -2147450848,
            0,
            -2147483648,
            32768,
            1081376,
            -2146435072,
            1048608,
            -2147483616,
            0,
            1081344,
            32800,
            -2146402304,
            -2146435072,
            32800,
            0,
            1081376,
            -2146435040,
            1048576,
            -2147450848,
            -2146435072,
            -2146402304,
            32768,
            -2146435072,
            -2147450880,
            32,
            -2146402272,
            1081376,
            32,
            32768,
            -2147483648,
            32800,
            -2146402304,
            1048576,
            -2147483616,
            1048608,
            -2147450848,
            -2147483616,
            1048608,
            1081344,
            0,
            -2147450880,
            32800,
            -2147483648,
            -2146435040,
            -2146402272,
            1081344
        ],
        104: [
            520,
            134349312,
            0,
            134348808,
            134218240,
            0,
            131592,
            134218240,
            131080,
            134217736,
            134217736,
            131072,
            134349320,
            131080,
            134348800,
            520,
            134217728,
            8,
            134349312,
            512,
            131584,
            134348800,
            134348808,
            131592,
            134218248,
            131584,
            131072,
            134218248,
            8,
            134349320,
            512,
            134217728,
            134349312,
            134217728,
            131080,
            520,
            131072,
            134349312,
            134218240,
            0,
            512,
            131080,
            134349320,
            134218240,
            134217736,
            512,
            0,
            134348808,
            134218248,
            131072,
            134217728,
            134349320,
            8,
            131592,
            131584,
            134217736,
            134348800,
            134218248,
            520,
            134348800,
            131592,
            8,
            134348808,
            131584
        ],
        105: [
            8396801,
            8321,
            8321,
            128,
            8396928,
            8388737,
            8388609,
            8193,
            0,
            8396800,
            8396800,
            8396929,
            129,
            0,
            8388736,
            8388609,
            1,
            8192,
            8388608,
            8396801,
            128,
            8388608,
            8193,
            8320,
            8388737,
            1,
            8320,
            8388736,
            8192,
            8396928,
            8396929,
            129,
            8388736,
            8388609,
            8396800,
            8396929,
            129,
            0,
            0,
            8396800,
            8320,
            8388736,
            8388737,
            1,
            8396801,
            8321,
            8321,
            128,
            8396929,
            129,
            1,
            8192,
            8388609,
            8193,
            8396928,
            8388737,
            8193,
            8320,
            8388608,
            8396801,
            128,
            8388608,
            8192,
            8396928
        ],
        106: [
            256,
            34078976,
            34078720,
            1107296512,
            524288,
            256,
            1073741824,
            34078720,
            1074266368,
            524288,
            33554688,
            1074266368,
            1107296512,
            1107820544,
            524544,
            1073741824,
            33554432,
            1074266112,
            1074266112,
            0,
            1073742080,
            1107820800,
            1107820800,
            33554688,
            1107820544,
            1073742080,
            0,
            1107296256,
            34078976,
            33554432,
            1107296256,
            524544,
            524288,
            1107296512,
            256,
            33554432,
            1073741824,
            34078720,
            1107296512,
            1074266368,
            33554688,
            1073741824,
            1107820544,
            34078976,
            1074266368,
            256,
            33554432,
            1107820544,
            1107820800,
            524544,
            1107296256,
            1107820800,
            34078720,
            0,
            1074266112,
            1107296256,
            524544,
            33554688,
            1073742080,
            524288,
            0,
            1074266112,
            34078976,
            1073742080
        ],
        107: [
            536870928,
            541065216,
            16384,
            541081616,
            541065216,
            16,
            541081616,
            4194304,
            536887296,
            4210704,
            4194304,
            536870928,
            4194320,
            536887296,
            536870912,
            16400,
            0,
            4194320,
            536887312,
            16384,
            4210688,
            536887312,
            16,
            541065232,
            541065232,
            0,
            4210704,
            541081600,
            16400,
            4210688,
            541081600,
            536870912,
            536887296,
            16,
            541065232,
            4210688,
            541081616,
            4194304,
            16400,
            536870928,
            4194304,
            536887296,
            536870912,
            16400,
            536870928,
            541081616,
            4210688,
            541065216,
            4210704,
            541081600,
            0,
            541065232,
            16,
            16384,
            541065216,
            4210704,
            16384,
            4194320,
            536887312,
            0,
            541081600,
            536870912,
            4194320,
            536887312
        ],
        108: [
            2097152,
            69206018,
            67110914,
            0,
            2048,
            67110914,
            2099202,
            69208064,
            69208066,
            2097152,
            0,
            67108866,
            2,
            67108864,
            69206018,
            2050,
            67110912,
            2099202,
            2097154,
            67110912,
            67108866,
            69206016,
            69208064,
            2097154,
            69206016,
            2048,
            2050,
            69208066,
            2099200,
            2,
            67108864,
            2099200,
            67108864,
            2099200,
            2097152,
            67110914,
            67110914,
            69206018,
            69206018,
            2,
            2097154,
            67108864,
            67110912,
            2097152,
            69208064,
            2050,
            2099202,
            69208064,
            2050,
            67108866,
            69208066,
            69206016,
            2099200,
            0,
            2,
            69208066,
            0,
            2099202,
            69206016,
            2048,
            67108866,
            67110912,
            2048,
            2097154
        ],
        109: [
            268439616,
            4096,
            262144,
            268701760,
            268435456,
            268439616,
            64,
            268435456,
            262208,
            268697600,
            268701760,
            266240,
            268701696,
            266304,
            4096,
            64,
            268697600,
            268435520,
            268439552,
            4160,
            266240,
            262208,
            268697664,
            268701696,
            4160,
            0,
            0,
            268697664,
            268435520,
            268439552,
            266304,
            262144,
            266304,
            262144,
            268701696,
            4096,
            64,
            268697664,
            4096,
            266304,
            268439552,
            64,
            268435520,
            268697600,
            268697664,
            268435456,
            262144,
            268439616,
            0,
            268701760,
            262208,
            268435520,
            268697600,
            268439552,
            268439616,
            0,
            268701760,
            266240,
            266240,
            4160,
            4160,
            262208,
            268435456,
            268701696
        ],
        110: [
            170135592,
            943396125,
            188091652,
            940642585,
            203819052,
            960042515,
            791809289,
            940319282,
            154347313,
            723321368,
            890975264,
            956902948,
            1024459794,
            185540652,
            622531092,
            120009992,
            873535509,
            53420041,
            924662276,
            119936026,
            839450637,
            118951446,
            875374343,
            372376066,
            437003809,
            908466438,
            170860555,
            70920229,
            321267986,
            1009791244,
            187570186,
            339223301
        ]
    }


    let data_dict = {
        32: [
            268439616,
            4096,
            262144,
            268701760,
            268435456,
            268439616,
            64,
            268435456,
            262208,
            268697600,
            268701760,
            266240,
            268701696,
            266304,
            4096,
            64,
            268697600,
            268435520,
            268439552,
            4160,
            266240,
            262208,
            268697664,
            268701696,
            4160,
            0,
            0,
            268697664,
            268435520,
            268439552,
            266304,
            262144,
            266304,
            262144,
            268701696,
            4096,
            64,
            268697664,
            4096,
            266304,
            268439552,
            64,
            268435520,
            268697600,
            268697664,
            268435456,
            262144,
            268439616,
            0,
            268701760,
            262208,
            268435520,
            268697600,
            268439552,
            268439616,
            0,
            268701760,
            266240,
            266240,
            4160,
            4160,
            262208,
            268435456,
            268701696
        ],

        81: [
            520,
            134349312,
            0,
            134348808,
            134218240,
            0,
            131592,
            134218240,
            131080,
            134217736,
            134217736,
            131072,
            134349320,
            131080,
            134348800,
            520,
            134217728,
            8,
            134349312,
            512,
            131584,
            134348800,
            134348808,
            131592,
            134218248,
            131584,
            131072,
            134218248,
            8,
            134349320,
            512,
            134217728,
            134349312,
            134217728,
            131080,
            520,
            131072,
            134349312,
            134218240,
            0,
            512,
            131080,
            134349320,
            134218240,
            134217736,
            512,
            0,
            134348808,
            134218248,
            131072,
            134217728,
            134349320,
            8,
            131592,
            131584,
            134217736,
            134348800,
            134218248,
            520,
            134348800,
            131592,
            8,
            134348808,
            131584
        ],

        84: [
            187050025,
            472920585,
            186915882,
            876157969,
            255199502,
            806945584,
            220596020,
            958210835,
            757275681,
            940378667,
            489892883,
            705504304,
            354103316,
            688857884,
            890312192,
            219096591,
            622400037,
            254088489,
            907618332,
            52759587,
            907877143,
            53870614,
            839463457,
            389417746,
            975774727,
            372382245,
            437136414,
            909246726,
            168694017,
            473575703,
            52697872,
            1010440969
        ],

        88: [
            8396801,
            8321,
            8321,
            128,
            8396928,
            8388737,
            8388609,
            8193,
            0,
            8396800,
            8396800,
            8396929,
            129,
            0,
            8388736,
            8388609,
            1,
            8192,
            8388608,
            8396801,
            128,
            8388608,
            8193,
            8320,
            8388737,
            1,
            8320,
            8388736,
            8192,
            8396928,
            8396929,
            129,
            8388736,
            8388609,
            8396800,
            8396929,
            129,
            0,
            0,
            8396800,
            8320,
            8388736,
            8388737,
            1,
            8396801,
            8321,
            8321,
            128,
            8396929,
            129,
            1,
            8192,
            8388609,
            8193,
            8396928,
            8388737,
            8193,
            8320,
            8388608,
            8396801,
            128,
            8388608,
            8192,
            8396928
        ],

        132: [
            -2146402272,
            -2147450880,
            32768,
            1081376,
            1048576,
            32,
            -2146435040,
            -2147450848,
            -2147483616,
            -2146402272,
            -2146402304,
            -2147483648,
            -2147450880,
            1048576,
            32,
            -2146435040,
            1081344,
            1048608,
            -2147450848,
            0,
            -2147483648,
            32768,
            1081376,
            -2146435072,
            1048608,
            -2147483616,
            0,
            1081344,
            32800,
            -2146402304,
            -2146435072,
            32800,
            0,
            1081376,
            -2146435040,
            1048576,
            -2147450848,
            -2146435072,
            -2146402304,
            32768,
            -2146435072,
            -2147450880,
            32,
            -2146402272,
            1081376,
            32,
            32768,
            -2147483648,
            32800,
            -2146402304,
            1048576,
            -2147483616,
            1048608,
            -2147450848,
            -2147483616,
            1048608,
            1081344,
            0,
            -2147450880,
            32800,
            -2147483648,
            -2146435040,
            -2146402272,
            1081344
        ],

        150: [
            536870928,
            541065216,
            16384,
            541081616,
            541065216,
            16,
            541081616,
            4194304,
            536887296,
            4210704,
            4194304,
            536870928,
            4194320,
            536887296,
            536870912,
            16400,
            0,
            4194320,
            536887312,
            16384,
            4210688,
            536887312,
            16,
            541065232,
            541065232,
            0,
            4210704,
            541081600,
            16400,
            4210688,
            541081600,
            536870912,
            536887296,
            16,
            541065232,
            4210688,
            541081616,
            4194304,
            16400,
            536870928,
            4194304,
            536887296,
            536870912,
            16400,
            536870928,
            541081616,
            4210688,
            541065216,
            4210704,
            541081600,
            0,
            541065232,
            16,
            16384,
            541065216,
            4210704,
            16384,
            4194320,
            536887312,
            0,
            541081600,
            536870912,
            4194320,
            536887312
        ],

        156: [
            16843776,
            0,
            65536,
            16843780,
            16842756,
            66564,
            4,
            65536,
            1024,
            16843776,
            16843780,
            1024,
            16778244,
            16842756,
            16777216,
            4,
            1028,
            16778240,
            16778240,
            66560,
            66560,
            16842752,
            16842752,
            16778244,
            65540,
            16777220,
            16777220,
            65540,
            0,
            1028,
            66564,
            16777216,
            65536,
            16843780,
            4,
            16842752,
            16843776,
            16777216,
            16777216,
            1024,
            16842756,
            65536,
            66560,
            16777220,
            1024,
            4,
            16778244,
            66564,
            16843780,
            65540,
            16842752,
            16778244,
            16777220,
            1028,
            66564,
            16843776,
            1028,
            16778240,
            16778240,
            0,
            65540,
            66560,
            0,
            16842756
        ],

        222: [
            2097152,
            69206018,
            67110914,
            0,
            2048,
            67110914,
            2099202,
            69208064,
            69208066,
            2097152,
            0,
            67108866,
            2,
            67108864,
            69206018,
            2050,
            67110912,
            2099202,
            2097154,
            67110912,
            67108866,
            69206016,
            69208064,
            2097154,
            69206016,
            2048,
            2050,
            69208066,
            2099200,
            2,
            67108864,
            2099200,
            67108864,
            2099200,
            2097152,
            67110914,
            67110914,
            69206018,
            69206018,
            2,
            2097154,
            67108864,
            67110912,
            2097152,
            69208064,
            2050,
            2099202,
            69208064,
            2050,
            67108866,
            69208066,
            69206016,
            2099200,
            0,
            2,
            69208066,
            0,
            2099202,
            69206016,
            2048,
            67108866,
            67110912,
            2048,
            2097154
        ],

        245: [
            256,
            34078976,
            34078720,
            1107296512,
            524288,
            256,
            1073741824,
            34078720,
            1074266368,
            524288,
            33554688,
            1074266368,
            1107296512,
            1107820544,
            524544,
            1073741824,
            33554432,
            1074266112,
            1074266112,
            0,
            1073742080,
            1107820800,
            1107820800,
            33554688,
            1107820544,
            1073742080,
            0,
            1107296256,
            34078976,
            33554432,
            1107296256,
            524544,
            524288,
            1107296512,
            256,
            33554432,
            1073741824,
            34078720,
            1107296512,
            1074266368,
            33554688,
            1073741824,
            1107820544,
            34078976,
            1074266368,
            256,
            33554432,
            1107820544,
            1107820800,
            524544,
            1107296256,
            1107820800,
            34078720,
            0,
            1074266112,
            1107296256,
            524544,
            33554688,
            1073742080,
            524288,
            0,
            1074266112,
            34078976,
            1073742080
        ],

    }

    const n = input_string.split("").map(function(x) {
        return x.charCodeAt()
    })
    let result_string = ""
    for (let j = 0; j < n.length; j+=8) {
        let c1 = (n[j] << 24) | (n[j + 1] << 16) | (n[j + 2] << 8) | n[j + 3]; // = 1698972985
        let c2 = (n[j + 4] << 24) | (n[j + 5] << 16) | (n[j + 6] << 8) | n[j + 7]; // = 1298817845

        let c3 = (c1 >>> 4) ^ c2; // = 1262364518
        let c4 = c3 & 252645135; // = 185468678
        let c5 = c2 ^ c4; // = 1180984371
        let c6 = c1 ^ (c4 << 4); // = -710658727
        let c7 = c6 >>> 16; // = 54692
        let c8 = c7 ^ c5; // = 1181004183
        let d1 = c8 & 65535; // = 45463
        let d2 = d1 << 16; // = -1315504128
        let d3 = c6 ^ d2; // = 1681077593
        let d4 = c5 ^ d1; // = 1181013412
        let d5 = d4 >>> 2; // = 295253353
        let d6 = d5 ^ d3; // = 1974075440
        let d7 = d6 & 858993459; // = 824311856
        let d8 = d3 ^ d7; // = 1427191145
        let e1 = d7 << 2; // = -997719872
        let e2 = d4 ^ e1; // = -2098408092
        let e3 = e2 >>> 8; // = 8580309
        let e4 = e3 ^ d8; // = 1435752892
        let e5 = e4 & 16711935; // = 9633980
        let e6 = d8 ^ e5; // = 1434596821
        let e7 = e6 >>> 1; // = 717298410
        let f2 = e5 << 8; // = -1828668416
        let f3 = e2 ^ f2; // = 300706148
        let q1 = e7 ^ f3 // = 992834446
        let f1 = q1 & 1431655765; // = 285561092
        let f4 = f3 ^ f1; // = 15284320
        let f5 = f4 << 1; // = 30568640
        let f6 = f4 >>> 31; // = 0
        let f7 = f5 | f6; // = 30568640

        function get_const(f7, params2, params3) {
            //
            let z0 = f7 ^ params2; // = 200696040
            let z1 = f7 >>> 4; // = 1910540
            let z2 = f7 << 28; // = 0
            let z3 = z1 | z2; // = 1910540
            let z4 = z3 ^ params3; // = 942027281
            let z5 = z0 >>> 24; // = 11
            let z6 = z5 & 63; // = 11
            let z7 = z0 >>> 16; // = 3062
            let z8 = z7 & 63; // = 54
            let z9 = data_dict[132][z6] | data_dict[88][z8]; // = -2139086720 // = -2139095040
            let z10 = z0 >>> 8; // = 783968
            let z11 = z10 & 63; // = 32
            let z12 = z9 | data_dict[150][z11]; // = -1602199424
            let z13 = z0 & 63; // = 40

            let z14 = z12 | data_dict[32][z13]; // = -1333759872
            let z15 = z4 >>> 24;  // = 56
            let z16 = z15 & 63; // = 56

            let z17 = z14 | data_dict[156][z16]; // = -1333758844
            let z18 = z4 >>> 16;  // = 14374
            let z19 = z18 & 63; // = 38

            let z20 = z17 | data_dict[81][z19]; // = -1199540604
            let z21 = z4 >>> 8; // = 3679794
            let z22 = z21 & 63; // = 50

            let z23 = z20 | data_dict[245][z22]; // = -92244348
            let z24 = z4 & 63; // = 17
            console.log(z23)

            let z25 = z23 | data_dict[222][z24]; // = -90145146
            return z25
        }


        let g1 = q1 & 1431655765; // = 285561092
        let g2 = g1 << 1; // = 571122184
        let g3 = e6 ^ g2; // = 2005440477
        let z04 = g3 << 1; // = -284086342
        let z03 = g3 >>> 31; // = 0
        let g4 = z04 | z03;

        let z01, z02;

// f7,
        console.log(f7)
        for (let i = 0; i < 32; i+=2) {
            z01 = get_const(f7, data_dict[84][i], data_dict[84][i+1]);
            z02 = f7;
            f7 = g4 ^ z01;
            g4 = z02;
        }
        console.log(f7, "f7")
        let n1 = (f7 >>> 1) | (f7 << 31); // = -1792532179
        let n2 = (g4 >>> 1) | (g4 << 31); // = -1087702964
        let n3 = n1 >>> 1; // = 1251217558
        let n4 = n3 ^ n2; // = -172037926
        let n5 = n4 & 1431655765; // = 1427390544
        let n6 = n2 ^ n5; // -364988388
        let n7 = n5 << 1; // = -1440186208
        let n8 = n1 ^ n7; // = 1057005965

        let m1 = n6 >>> 8; // = 15351480
        let m2 = m1 ^ n8; // = 1072340789
        let m3 = m2 & 16711935; // = 15335477
        let m4 = m3 << 8; // = -369085184
        let m5 = n6 ^ m4; // = 4099356
        let m6 = m5 >>> 2;  // = 1024839
        let m7 = n8 ^ m3; // = 1072341432
        let m8 = m6 ^ m7; // = 1071973119

        let b1 = m8 & 858993459; // = 857801267
        let b2 = m7 ^ b1; // = 214672267
        let b3 = b2 >>> 16; // = 3275
        let b4 = b1 << 2; // =  -863762228
        let b5 = m5 ^ b4; // = -860191280
        let b6 = b3 ^ b5; // = -860190437
        let b7 = b6 & 65535; // = 35099
        let b8 = b7 << 16; // = -1994719232

        let v1 = b2 ^ b8; // = -2049924213
        let v2 = v1 >>> 4; // = 140315192
        let v3 = b5 ^ b7; // = -860222261
        let v4 = v2 ^ v3; // = -991492365
        let v5 = v4 & 252645135; // = 67569155
        let v6 = v5 << 4; // = 1081106480
        let v7 = v1 ^ v6; // = -979319877
        let v8 = v3 ^ v5; // = -927135032
        function get_result_str(v7, v8) {
            let n_list = []

            n_list.push(v7 >>> 24)
            n_list.push((v7 >>> 16) & 255)
            n_list.push((v7 >>> 8) & 255)
            n_list.push(v7 & 255)
            n_list.push(v8 >>> 24)
            n_list.push((v8 >>> 16) & 255)
            n_list.push((v8 >>> 8) & 255)
            n_list.push(v8 & 255)


            let result = ""
            const table = "0123456789abcdef"
            for (var i = 0; i < n_list.length; i++) {
                result += table[n_list[i] >> 4];
                result += table[n_list[i] & 15];
            }
            return result
        }
        result_string += get_result_str(v7, v8);
    }
    return result_string;
}



function xhs_hash_0520(input_string) {
    let data_dict = {
        102: [
            16843776,
            0,
            65536,
            16843780,
            16842756,
            66564,
            4,
            65536,
            1024,
            16843776,
            16843780,
            1024,
            16778244,
            16842756,
            16777216,
            4,
            1028,
            16778240,
            16778240,
            66560,
            66560,
            16842752,
            16842752,
            16778244,
            65540,
            16777220,
            16777220,
            65540,
            0,
            1028,
            66564,
            16777216,
            65536,
            16843780,
            4,
            16842752,
            16843776,
            16777216,
            16777216,
            1024,
            16842756,
            65536,
            66560,
            16777220,
            1024,
            4,
            16778244,
            66564,
            16843780,
            65540,
            16842752,
            16778244,
            16777220,
            1028,
            66564,
            16843776,
            1028,
            16778240,
            16778240,
            0,
            65540,
            66560,
            0,
            16842756
        ],
        103: [
            -2146402272,
            -2147450880,
            32768,
            1081376,
            1048576,
            32,
            -2146435040,
            -2147450848,
            -2147483616,
            -2146402272,
            -2146402304,
            -2147483648,
            -2147450880,
            1048576,
            32,
            -2146435040,
            1081344,
            1048608,
            -2147450848,
            0,
            -2147483648,
            32768,
            1081376,
            -2146435072,
            1048608,
            -2147483616,
            0,
            1081344,
            32800,
            -2146402304,
            -2146435072,
            32800,
            0,
            1081376,
            -2146435040,
            1048576,
            -2147450848,
            -2146435072,
            -2146402304,
            32768,
            -2146435072,
            -2147450880,
            32,
            -2146402272,
            1081376,
            32,
            32768,
            -2147483648,
            32800,
            -2146402304,
            1048576,
            -2147483616,
            1048608,
            -2147450848,
            -2147483616,
            1048608,
            1081344,
            0,
            -2147450880,
            32800,
            -2147483648,
            -2146435040,
            -2146402272,
            1081344
        ],
        104: [
            520,
            134349312,
            0,
            134348808,
            134218240,
            0,
            131592,
            134218240,
            131080,
            134217736,
            134217736,
            131072,
            134349320,
            131080,
            134348800,
            520,
            134217728,
            8,
            134349312,
            512,
            131584,
            134348800,
            134348808,
            131592,
            134218248,
            131584,
            131072,
            134218248,
            8,
            134349320,
            512,
            134217728,
            134349312,
            134217728,
            131080,
            520,
            131072,
            134349312,
            134218240,
            0,
            512,
            131080,
            134349320,
            134218240,
            134217736,
            512,
            0,
            134348808,
            134218248,
            131072,
            134217728,
            134349320,
            8,
            131592,
            131584,
            134217736,
            134348800,
            134218248,
            520,
            134348800,
            131592,
            8,
            134348808,
            131584
        ],
        105: [
            8396801,
            8321,
            8321,
            128,
            8396928,
            8388737,
            8388609,
            8193,
            0,
            8396800,
            8396800,
            8396929,
            129,
            0,
            8388736,
            8388609,
            1,
            8192,
            8388608,
            8396801,
            128,
            8388608,
            8193,
            8320,
            8388737,
            1,
            8320,
            8388736,
            8192,
            8396928,
            8396929,
            129,
            8388736,
            8388609,
            8396800,
            8396929,
            129,
            0,
            0,
            8396800,
            8320,
            8388736,
            8388737,
            1,
            8396801,
            8321,
            8321,
            128,
            8396929,
            129,
            1,
            8192,
            8388609,
            8193,
            8396928,
            8388737,
            8193,
            8320,
            8388608,
            8396801,
            128,
            8388608,
            8192,
            8396928
        ],
        106: [
            256,
            34078976,
            34078720,
            1107296512,
            524288,
            256,
            1073741824,
            34078720,
            1074266368,
            524288,
            33554688,
            1074266368,
            1107296512,
            1107820544,
            524544,
            1073741824,
            33554432,
            1074266112,
            1074266112,
            0,
            1073742080,
            1107820800,
            1107820800,
            33554688,
            1107820544,
            1073742080,
            0,
            1107296256,
            34078976,
            33554432,
            1107296256,
            524544,
            524288,
            1107296512,
            256,
            33554432,
            1073741824,
            34078720,
            1107296512,
            1074266368,
            33554688,
            1073741824,
            1107820544,
            34078976,
            1074266368,
            256,
            33554432,
            1107820544,
            1107820800,
            524544,
            1107296256,
            1107820800,
            34078720,
            0,
            1074266112,
            1107296256,
            524544,
            33554688,
            1073742080,
            524288,
            0,
            1074266112,
            34078976,
            1073742080
        ],
        107: [
            536870928,
            541065216,
            16384,
            541081616,
            541065216,
            16,
            541081616,
            4194304,
            536887296,
            4210704,
            4194304,
            536870928,
            4194320,
            536887296,
            536870912,
            16400,
            0,
            4194320,
            536887312,
            16384,
            4210688,
            536887312,
            16,
            541065232,
            541065232,
            0,
            4210704,
            541081600,
            16400,
            4210688,
            541081600,
            536870912,
            536887296,
            16,
            541065232,
            4210688,
            541081616,
            4194304,
            16400,
            536870928,
            4194304,
            536887296,
            536870912,
            16400,
            536870928,
            541081616,
            4210688,
            541065216,
            4210704,
            541081600,
            0,
            541065232,
            16,
            16384,
            541065216,
            4210704,
            16384,
            4194320,
            536887312,
            0,
            541081600,
            536870912,
            4194320,
            536887312
        ],
        108: [
            2097152,
            69206018,
            67110914,
            0,
            2048,
            67110914,
            2099202,
            69208064,
            69208066,
            2097152,
            0,
            67108866,
            2,
            67108864,
            69206018,
            2050,
            67110912,
            2099202,
            2097154,
            67110912,
            67108866,
            69206016,
            69208064,
            2097154,
            69206016,
            2048,
            2050,
            69208066,
            2099200,
            2,
            67108864,
            2099200,
            67108864,
            2099200,
            2097152,
            67110914,
            67110914,
            69206018,
            69206018,
            2,
            2097154,
            67108864,
            67110912,
            2097152,
            69208064,
            2050,
            2099202,
            69208064,
            2050,
            67108866,
            69208066,
            69206016,
            2099200,
            0,
            2,
            69208066,
            0,
            2099202,
            69206016,
            2048,
            67108866,
            67110912,
            2048,
            2097154
        ],
        109: [
            268439616,
            4096,
            262144,
            268701760,
            268435456,
            268439616,
            64,
            268435456,
            262208,
            268697600,
            268701760,
            266240,
            268701696,
            266304,
            4096,
            64,
            268697600,
            268435520,
            268439552,
            4160,
            266240,
            262208,
            268697664,
            268701696,
            4160,
            0,
            0,
            268697664,
            268435520,
            268439552,
            266304,
            262144,
            266304,
            262144,
            268701696,
            4096,
            64,
            268697664,
            4096,
            266304,
            268439552,
            64,
            268435520,
            268697600,
            268697664,
            268435456,
            262144,
            268439616,
            0,
            268701760,
            262208,
            268435520,
            268697600,
            268439552,
            268439616,
            0,
            268701760,
            266240,
            266240,
            4160,
            4160,
            262208,
            268435456,
            268701696
        ],
        110: [
            170135592,
            943396125,
            188091652,
            940642585,
            203819052,
            960042515,
            791809289,
            940319282,
            154347313,
            723321368,
            890975264,
            956902948,
            1024459794,
            185540652,
            622531092,
            120009992,
            873535509,
            53420041,
            924662276,
            119936026,
            839450637,
            118951446,
            875374343,
            372376066,
            437003809,
            908466438,
            170860555,
            70920229,
            321267986,
            1009791244,
            187570186,
            339223301
        ]
    }
    const n = input_string.split("").map(function(x) {
        // console.log(x, x.charCodeAt())
        return x.charCodeAt()
    })
    let result_string = ""
    for (let j = 0; j < n.length; j+=8) {
        // console.log(n[j])
        let c1 = (n[j] << 24) | (n[j + 1] << 16) | (n[j + 2] << 8) | n[j + 3]; // = 1698972985
        let c2 = (n[j + 4] << 24) | (n[j + 5] << 16) | (n[j + 6] << 8) | n[j + 7]; // = 1298817845

        let c3 = (c1 >>> 4) ^ c2; // = 1262364518
        let c4 = c3 & 252645135; // = 185468678
        let c5 = c2 ^ c4; // = 1180984371
        let c6 = c1 ^ (c4 << 4); // = -710658727
        let c7 = c6 >>> 16; // = 54692
        let c8 = c7 ^ c5; // = 1181004183
        let d1 = c8 & 65535; // = 45463
        let d2 = d1 << 16; // = -1315504128
        let d3 = c6 ^ d2; // = 1681077593
        let d4 = c5 ^ d1; // = 1181013412
        let d5 = d4 >>> 2; // = 295253353
        let d6 = d5 ^ d3; // = 1974075440
        let d7 = d6 & 858993459; // = 824311856
        let d8 = d3 ^ d7; // = 1427191145
        let e1 = d7 << 2; // = -997719872
        let e2 = d4 ^ e1; // = -2098408092
        let e3 = e2 >>> 8; // = 8580309
        let e4 = e3 ^ d8; // = 1435752892
        let e5 = e4 & 16711935; // = 9633980
        let e6 = d8 ^ e5; // = 1434596821
        let e7 = e6 >>> 1; // = 717298410
        let f2 = e5 << 8; // = -1828668416
        let f3 = e2 ^ f2; // = 300706148
        let q1 = e7 ^ f3 // = 992834446
        let f1 = q1 & 1431655765; // = 285561092
        let f4 = f3 ^ f1; // = 15284320
        let f5 = f4 << 1; // = 30568640
        let f6 = f4 >>> 31; // = 0
        let f7 = f5 | f6; // = 30568640
        // console.log(f3, "^", f1)

        function get_const(f7, params2, params3) {
            //
            let z0 = f7 ^ params2; // = 200696040
            let z1 = f7 >>> 4; // = 1910540
            let z2 = f7 << 28; // = 0
            let z3 = z1 | z2; // = 1910540
            let z4 = z3 ^ params3; // = 942027281
            let z5 = z0 >>> 24; // = 11
            let z6 = z5 & 63; // = 11
            let z7 = z0 >>> 16; // = 3062
            let z8 = z7 & 63; // = 54
            let z9 = data_dict[103][z6] | data_dict[105][z8]; // = -2139086720 // = -2139095040
            let z10 = z0 >>> 8; // = 783968
            let z11 = z10 & 63; // = 32
            let z12 = z9 | data_dict[107][z11]; // = -1602199424
            let z13 = z0 & 63; // = 40
            let z14 = z12 | data_dict[109][z13]; // = -1333759872
            let z15 = z4 >>> 24;  // = 56
            let z16 = z15 & 63; // = 56
            let z17 = z14 | data_dict[102][z16]; // = -1333758844
            let z18 = z4 >>> 16;  // = 14374
            let z19 = z18 & 63; // = 38
            let z20 = z17 | data_dict[104][z19]; // = -1199540604
            let z21 = z4 >>> 8; // = 3679794
            let z22 = z21 & 63; // = 50
            let z23 = z20 | data_dict[106][z22]; // = -92244348
            let z24 = z4 & 63; // = 17
            let z25 = z23 | data_dict[108][z24]; // = -90145146
            return z25
        }


        let g1 = q1 & 1431655765; // = 285561092
        let g2 = g1 << 1; // = 571122184
        let g3 = e6 ^ g2; // = 2005440477
        let z04 = g3 << 1; // = -284086342
        let z03 = g3 >>> 31; // = 0
        let g4 = z04 | z03;

        let z01, z02;

// f7,
        for (let i = 0; i < 32; i+=2) {
            z01 = get_const(f7, data_dict[110][i], data_dict[110][i+1]);
            z02 = f7;
            f7 = g4 ^ z01;
            g4 = z02;
        }
        let n1 = (f7 >>> 1) | (f7 << 31); // = -1792532179
        let n2 = (g4 >>> 1) | (g4 << 31); // = -1087702964
        let n3 = n1 >>> 1; // = 1251217558
        let n4 = n3 ^ n2; // = -172037926
        let n5 = n4 & 1431655765; // = 1427390544
        let n6 = n2 ^ n5; // -364988388
        let n7 = n5 << 1; // = -1440186208
        let n8 = n1 ^ n7; // = 1057005965

        let m1 = n6 >>> 8; // = 15351480
        let m2 = m1 ^ n8; // = 1072340789
        let m3 = m2 & 16711935; // = 15335477
        let m4 = m3 << 8; // = -369085184
        let m5 = n6 ^ m4; // = 4099356
        let m6 = m5 >>> 2;  // = 1024839
        let m7 = n8 ^ m3; // = 1072341432
        let m8 = m6 ^ m7; // = 1071973119

        let b1 = m8 & 858993459; // = 857801267
        let b2 = m7 ^ b1; // = 214672267
        let b3 = b2 >>> 16; // = 3275
        let b4 = b1 << 2; // =  -863762228
        let b5 = m5 ^ b4; // = -860191280
        let b6 = b3 ^ b5; // = -860190437
        let b7 = b6 & 65535; // = 35099
        let b8 = b7 << 16; // = -1994719232

        let v1 = b2 ^ b8; // = -2049924213
        let v2 = v1 >>> 4; // = 140315192
        let v3 = b5 ^ b7; // = -860222261
        let v4 = v2 ^ v3; // = -991492365
        let v5 = v4 & 252645135; // = 67569155
        let v6 = v5 << 4; // = 1081106480
        let v7 = v1 ^ v6; // = -979319877
        let v8 = v3 ^ v5; // = -927135032
        function get_result_str(v7, v8) {
            let n_list = []

            n_list.push(v7 >>> 24)
            n_list.push((v7 >>> 16) & 255)
            n_list.push((v7 >>> 8) & 255)
            n_list.push(v7 & 255)
            n_list.push(v8 >>> 24)
            n_list.push((v8 >>> 16) & 255)
            n_list.push((v8 >>> 8) & 255)
            n_list.push(v8 & 255)


            let result = ""
            const table = "0123456789abcdef"
            for (var i = 0; i < n_list.length; i++) {
                result += table[n_list[i] >> 4];
                result += table[n_list[i] & 15];
            }
            return result
        }
        result_string += get_result_str(v7, v8);
    }
    return result_string;
}
// const source_str = 'x1=27961bd71b7cfd6fe3f657fa99fc5a57;x2=0|0|0|1|0|0|1|0|0|0|1|0|0|0|0;x3=1879369b667ucsk706nvol6i3aq3u1nrsljgf6ibi30000105546;x4=1684571715891;'
// const source_str = 'x1=27961bd71b7cfd6fe3f657fa99fc5a57;x2=0|0|0|1|0|0|1|0|0|0|1|0|0|0|0;x3=1879369b667ucsk706nvol6i3aq3u1nrsljgf6ibi30000105546;x4=1684813175078;'
// x1 计算规则： md5('url=/api/sns/web/v1/homefeed{"cursor_score":"14565","num":18,"refresh_type":3,"note_index":33,"unread_begin_note_id":"","unread_end_note_id":"","unread_note_count":0,"category":"homefeed.food_v3","search_key":""}'.encode()).hexdigest()

const source_str = 'x1=8ff7994b4224e385d95d59e8a02bd465;x2=0|0|0|1|0|0|1|0|0|0|1|0|0|0|0;x3=1879369b667ucsk706nvol6i3aq3u1nrsljgf6ibi30000105546;x4=1685510990754;'
const input_str = Buffer.from(source_str).toString("base64");

console.log(input_str)

const payload = xhs_hash_0531(input_str)
console.log(payload)
const data = '{"signSvn":"51","signType":"x1","appId":"xhs-pc-web","signVersion":"1","payload":"' + payload +'"}'
const result = Buffer.from(data).toString("base64");

console.log("X-S====>", "XYW_" + result);
